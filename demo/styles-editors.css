/**
 * SCRIPTA Demo - Editors Styles
 * CNL Editor, Dialogue Editor, Generated Story, Generation Strategy
 */

/* ============================================ */
/* CNL Editor */
/* ============================================ */
.cnl-editor-container { height: 100%; display: flex; flex-direction: column; }
.cnl-toolbar {
  display: flex; justify-content: space-between; align-items: center;
  padding: 0.5rem; background: var(--bg-surface); border-radius: 8px 8px 0 0;
}
.toolbar-title { font-size: var(--fs-base); font-weight: 500; }
.toolbar-actions { display: flex; gap: 0.3rem; }

.cnl-editor-wrapper { flex: 1; display: flex; position: relative; background: var(--bg-elevated); border: 1px solid var(--bg-hover); overflow: hidden; }
.line-numbers {
  width: 40px; padding: 0.5rem 0.3rem; text-align: right;
  background: var(--bg-surface); color: var(--text-muted);
  font-family: 'JetBrains Mono', monospace; font-size: var(--fs-sm); line-height: 1.5;
  overflow: hidden; user-select: none;
}
.line-numbers span { display: block; }
.cnl-textarea {
  flex: 1; padding: 0.5rem; background: transparent; border: none;
  color: var(--text-primary); font-family: 'JetBrains Mono', monospace;
  font-size: var(--fs-sm); line-height: 1.5; resize: none;
}
.cnl-textarea:focus { outline: none; }

.cnl-status { padding: 0.3rem 0.5rem; font-size: var(--fs-sm); background: var(--bg-surface); border-radius: 0 0 8px 8px; }
.status-success { color: var(--accent-green); }
.status-error { color: var(--accent-coral); }

.cnl-errors { margin-top: 0.5rem; }
.error-list { background: rgba(255,100,100,0.1); border-radius: 4px; padding: 0.5rem; }
.error-item { font-size: var(--fs-sm); color: var(--accent-coral); padding: 0.2rem 0; }

.cnl-help { margin-top: 0.5rem; }
.cnl-help summary { cursor: pointer; font-size: var(--fs-sm); color: var(--text-muted); }
.help-content { margin-top: 0.5rem; }
.syntax-table { width: 100%; font-size: var(--fs-sm); border-collapse: collapse; }
.syntax-table th, .syntax-table td { padding: 0.3rem 0.5rem; text-align: left; border-bottom: 1px solid var(--bg-hover); }
.syntax-table th { color: var(--text-secondary); }
.syntax-table td:first-child { color: var(--accent); font-family: 'JetBrains Mono', monospace; }

/* CNL Tab Toolbar */
.cnl-toolbar {
  display: flex; gap: 0.5rem; padding: 0.5rem;
  background: var(--bg-surface); border-radius: 6px;
  margin-bottom: 0.5rem; justify-content: flex-end;
}
.cnl-toolbar .btn { font-size: var(--fs-xs); padding: 0.4rem 0.8rem; }

/* ============================================ */
/* Dialogue Editor Styles */
/* ============================================ */
.dialogue-editor { display: flex; height: 100%; gap: 1rem; }
.dialogue-sidebar { width: 220px; background: var(--bg-surface); border-radius: 8px; display: flex; flex-direction: column; }
.sidebar-header { display: flex; justify-content: space-between; align-items: center; padding: 0.8rem; border-bottom: 1px solid var(--bg-hover); }
.sidebar-header h3 { margin: 0; font-size: var(--fs-base); }

.dialogue-list { flex: 1; overflow: auto; padding: 0.5rem; }
.dialogue-item {
  display: flex; align-items: center; gap: 0.5rem;
  padding: 0.5rem; margin-bottom: 0.3rem;
  background: var(--bg-elevated); border-radius: 6px; cursor: pointer;
}
.dialogue-item:hover { background: var(--bg-hover); }
.dialogue-item.selected { background: var(--accent); color: var(--bg-deep); }
.item-icon { font-size: var(--fs-md); }
.item-info { flex: 1; }
.item-purpose { font-size: var(--fs-sm); display: block; }
.item-beat { font-size: var(--fs-xs); color: var(--text-muted); }
.dialogue-item.selected .item-beat { color: rgba(0,0,0,0.5); }

.dialogue-main { flex: 1; background: var(--bg-surface); border-radius: 8px; padding: 1rem; overflow: auto; }
.no-selection { display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-muted); }

.dialogue-form h3 { margin: 0 0 1rem; font-size: var(--fs-md); }
.form-section { margin-bottom: 1rem; }
.form-section label { display: block; font-size: var(--fs-sm); color: var(--text-muted); margin-bottom: 0.3rem; }
.form-row { display: flex; gap: 1rem; }
.form-row .form-section { flex: 1; }

.purpose-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); gap: 0.3rem; }
.purpose-option { cursor: pointer; }
.purpose-option input { display: none; }
.purpose-option span { display: block; text-align: center; }
.purpose-icon { font-size: var(--fs-lg); }
.purpose-label { font-size: var(--fs-xs); }
.purpose-option {
  padding: 0.4rem; border: 1px solid var(--bg-hover);
  border-radius: 6px; background: var(--bg-elevated); transition: all 0.2s;
}
.purpose-option:hover { border-color: var(--accent); }
.purpose-option.selected, .purpose-option input:checked + span {
  border-color: var(--accent); background: var(--accent); color: var(--bg-deep);
}

.participants-list { display: flex; flex-direction: column; gap: 0.3rem; }
.participant-row { display: flex; gap: 0.5rem; align-items: center; }
.participant-character, .participant-role {
  padding: 0.4rem; background: var(--bg-elevated); border: 1px solid var(--bg-hover);
  color: var(--text-primary); border-radius: 4px; font-size: var(--fs-sm);
}
.participant-character { flex: 2; }
.participant-role { flex: 1; }

.exchanges-list { display: flex; flex-direction: column; gap: 0.8rem; margin-bottom: 0.5rem; }
.exchange-row { background: var(--bg-elevated); border-radius: 6px; padding: 0.8rem; }
.exchange-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
.exchange-speaker { padding: 0.3rem; background: var(--bg-surface); border: 1px solid var(--bg-hover); color: var(--text-primary); border-radius: 4px; font-size: var(--fs-sm); }
.exchange-fields { display: flex; flex-direction: column; gap: 0.4rem; }
.exchange-fields .field { display: flex; flex-direction: column; gap: 0.2rem; }
.exchange-fields label { font-size: var(--fs-xs); color: var(--text-muted); }
.exchange-intent, .exchange-emotion, .exchange-sketch {
  padding: 0.4rem; background: var(--bg-surface); border: 1px solid var(--bg-hover);
  color: var(--text-primary); border-radius: 4px; font-size: var(--fs-sm);
}
.exchange-sketch { font-family: 'Crimson Text', serif; font-style: italic; }

.form-actions { display: flex; gap: 0.5rem; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--bg-hover); }

.btn-small { padding: 0.3rem 0.6rem; font-size: var(--fs-sm); }
.btn-remove, .btn-remove-participant, .btn-remove-exchange, .btn-delete {
  background: transparent; border: none; color: var(--accent-coral);
  cursor: pointer; font-size: var(--fs-md); padding: 0.2rem 0.4rem;
}
.btn-remove:hover, .btn-remove-participant:hover, .btn-remove-exchange:hover, .btn-delete:hover {
  background: rgba(255,100,100,0.2); border-radius: 4px;
}

.warning-box { background: rgba(255,200,100,0.1); border: 1px solid var(--accent-gold); border-radius: 8px; padding: 1rem; text-align: center; }
.warning-box p { margin: 0 0 0.5rem; color: var(--accent-gold); }

/* ============================================
   IMPROVE STORY PLAN
   ============================================ */
.improve-plan { padding: 0.5rem; }
.change-category { margin-bottom: 1rem; }
.change-category-header { 
  font-weight: 600; color: var(--accent); padding: 0.5rem;
  background: var(--bg-elevated); border-radius: 4px; margin-bottom: 0.5rem;
}
.change-list { list-style: none; padding: 0; margin: 0; }
.change-list li {
  display: flex; align-items: center; gap: 0.5rem;
  padding: 0.4rem 0.6rem; border-radius: 4px; margin-bottom: 0.25rem;
}
.change-action { 
  width: 1.2rem; height: 1.2rem; display: flex; align-items: center; justify-content: center;
  border-radius: 50%; font-weight: bold; font-size: var(--fs-sm);
}
.change-added { background: rgba(100,200,100,0.1); }
.change-added .change-action { background: var(--accent-teal); color: var(--bg-dark); }
.change-removed { background: rgba(200,100,100,0.1); }
.change-removed .change-action { background: var(--accent-coral); color: var(--bg-dark); }
.change-modified { background: rgba(200,200,100,0.1); }
.change-modified .change-action { background: var(--accent-gold); color: var(--bg-dark); }
.change-name { color: var(--text-primary); }
.improve-actions { margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid var(--bg-hover); }

/* ============================================
   GENERATED STORY VIEW
   ============================================ */
.generated-story-container { height: 100%; display: flex; flex-direction: column; }
.generated-story-toolbar { 
  display: flex; gap: 0.5rem; padding: 0.5rem; 
  background: var(--bg-elevated); border-radius: 6px; margin-bottom: 0.5rem;
}
.generated-story-content {
  flex: 1; overflow-y: auto; padding: 1.5rem; background: var(--bg-surface);
  border-radius: 8px; font-family: 'Crimson Text', serif; font-size: var(--fs-lg);
  line-height: 1.8; color: var(--text-primary);
}
.generated-story-content h1 { font-family: 'Cinzel', serif; color: var(--accent); margin-bottom: 1rem; }
.generated-story-content h2 { font-family: 'Cinzel', serif; color: var(--accent-teal); margin-top: 2rem; margin-bottom: 0.5rem; }
.generated-story-content h3 { color: var(--text-secondary); margin-top: 1.5rem; margin-bottom: 0.5rem; }
.generated-story-content p { margin-bottom: 1rem; text-align: justify; }
.generated-story-empty { 
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  height: 100%; color: var(--text-muted); text-align: center; gap: 1rem;
}
.generated-story-empty .icon { font-size: 3rem; opacity: 0.5; }
.generating-indicator { display: flex; align-items: center; gap: 0.5rem; color: var(--accent-teal); }
.generating-indicator .spinner {
  width: 1rem; height: 1rem; border: 2px solid var(--bg-hover);
  border-top-color: var(--accent-teal); border-radius: 50%; animation: spin 1s linear infinite;
}

/* ============================================
   GENERATION STRATEGY OPTIONS
   ============================================ */
.strategy-options { display: flex; flex-direction: column; gap: 0.5rem; }
.strategy-option {
  display: flex; align-items: flex-start; gap: 0.75rem; padding: 0.75rem;
  background: var(--bg-surface); border: 2px solid var(--bg-hover);
  border-radius: 8px; cursor: pointer; transition: all 0.2s;
}
.strategy-option:hover { border-color: var(--accent); background: var(--bg-elevated); }
.strategy-option:has(input:checked) { 
  border-color: var(--accent); background: rgba(212, 175, 55, 0.1);
}
.strategy-option input[type="radio"] { 
  margin-top: 0.2rem; accent-color: var(--accent); 
  width: 1rem; height: 1rem; flex-shrink: 0;
}
.strategy-content { flex: 1; }
.strategy-title { 
  font-weight: 600; color: var(--text-primary); margin-bottom: 0.25rem; 
}
.strategy-option:has(input:checked) .strategy-title { color: var(--accent); }
.strategy-desc { 
  font-size: var(--fs-sm); color: var(--text-muted); line-height: 1.4; 
}
.strategy-badge {
  font-size: var(--fs-xs); padding: 0.15rem 0.4rem; border-radius: 3px;
  margin-left: 0.5rem; font-weight: 500;
}
.strategy-badge.fast { background: var(--accent-teal); color: var(--bg-dark); }
.strategy-badge.api { background: var(--accent-coral); color: var(--bg-dark); }
.strategy-badge.quality { background: var(--accent); color: var(--bg-dark); }

/* Generation progress indicator */
.generation-progress {
  display: none; flex-direction: column; gap: 0.5rem; padding: 1rem;
  background: var(--bg-elevated); border-radius: 8px; margin-top: 1rem;
}
.generation-progress.active { display: flex; }
.progress-header { display: flex; justify-content: space-between; align-items: center; }
.progress-title { font-weight: 600; color: var(--accent); }
.progress-bar-container { height: 8px; background: var(--bg-hover); border-radius: 4px; overflow: hidden; }
.progress-bar { height: 100%; background: var(--accent-teal); transition: width 0.3s; }
.progress-status { font-size: var(--fs-sm); color: var(--text-muted); }
.progress-metrics { display: flex; gap: 1rem; font-size: var(--fs-sm); color: var(--text-secondary); }
.progress-metrics span { display: flex; align-items: center; gap: 0.25rem; }

/* Generation loading overlay (for LLM/Advanced strategies) */
.generation-loading-overlay {
  position: absolute;
  inset: 0;
  background: rgba(26, 26, 46, 0.9);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;
  border-radius: 8px;
}

.generation-loading-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1rem;
  text-align: center;
  padding: 2rem;
}

.generation-loading-text {
  font-size: var(--fs-md);
  color: var(--text-primary);
  font-weight: 600;
}

.generation-loading-hint {
  font-size: var(--fs-sm);
  color: var(--text-muted);
}

/* Make modal body position relative for overlay */
#generate-modal-body {
  position: relative;
}
